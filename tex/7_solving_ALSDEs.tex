% !TeX root = ../dissertation.tex

\section{Motivation}
\footnotetextonly{This chapter previously appeared in the following open-access article: \fullcite{KuoShresthaSinhaSundar2022}.}

In this chapter, we fix \( t âˆˆ [0, 1] \). Our goal is to find the solution of the linear stochastic differential equation
\begin{equation}  \label{eqn:SDE_drift}
    \left\{
    \begin{aligned}
        \dif Z(t)  & =  f\br{âˆ«_0^1 Î³(s) \dif W_s} ~ Z(t) \dif t + Ïƒ_t ~ Z(t) \dif W_t  \\
             Z(0)  & =  Î¾ ,
    \end{aligned}
    \right.
\end{equation}
under reasonable conditions on \( Î³ \), \( Ïƒ \), \( f \), and \( Î¾ \). Note that the anticipation comes from the drift. We shall explore finding the solution using: (1) Ayedâ€“Kuo theory by formulating an ansatz, and (2) Skorokhod integral and a novel braiding technique. We shall see that the Ayedâ€“Kuo theory gives us a much simpler method to find the solution, albeit at the cost of requiring us to guess the form of the solution first. On the other hand, the braiding technique is constructive and is amenable to solving other types of equations. Both the methods yield identical solution under the same constraints.



\section{The Ayedâ€“Kuo solution}  \label{sec:SDE_drift_Ayedâ€“Kuo}

\begin{theorem}  \label{thm:SDE_drift_Ayedâ€“Kuo}  \index{stochastic differential equation!existence}
    Suppose \( Ïƒ âˆˆ L^2_\text{ad}([0, 1] Ã— Î©) \), \( Î³ âˆˆ L^2[0, 1] \), and \( Î¾ \) be a random variable independent of the Wiener process \( W \). Moreover, suppose \( f âˆˆ C^2(â„) \) along with \( f, f', f'' âˆˆ L^1(â„) \). Then the solution of \cref{eqn:SDE_drift} in the Ayedâ€“Kuo theory is given by
    \begin{equation}  \label{eqn:SDE_drift_solution_Ayedâ€“Kuo}
        Z(t) = Î¾ \exp\bs{ âˆ«_0^t Ïƒ_s \dif W_s - \frac12 âˆ«_0^t Ïƒ_s^2 \dif s + âˆ«_0^t f\br{ âˆ«_0^1 Î³(u) \dif W_u - âˆ«_s^t Î³(u) ~ Ïƒ_u \dif u } \dif s } .
    \end{equation}
\end{theorem}

\begin{proof}
    We show that \cref{eqn:SDE_drift_solution_Ayedâ€“Kuo} solves \cref{eqn:SDE_drift}. The initial condition is trivially verified.

    Note that \cref{eqn:SDE_drift_solution_Ayedâ€“Kuo} can be written as
    \begin{align*}
        Z(t)  =
        &  Î¾ \exp\left[ âˆ«_0^t Ïƒ_s \dif W_s - \frac12 âˆ«_0^t Ïƒ_s^2 \dif s \right.  \\
        &  \qquad \qquad  \left. + âˆ«_0^t f\br{ âˆ«_0^t Î³(u) \dif W_u + âˆ«_t^1 Î³(u) \dif W_u - âˆ«_s^t Î³(u) ~ Ïƒ_u \dif u } \dif s \right] .
    \end{align*}
    Motivated by this, we define
    \begin{equation*}
        Î¸(t, x_1, x_2, y) =  Î¾ \exp\bs{ x_1 - \frac12 âˆ«_0^t Ïƒ_s^2 \dif s + âˆ«_0^t f\br{ x_2 + y - âˆ«_s^t Î³(u) ~ Ïƒ_u \dif u } \dif s } .
    \end{equation*}
    Moreover, let
    \begin{align*}
                X^{(1)}_t  & =  âˆ«_0^t Ïƒ_s  \dif W_s  &&  (\text{so } \dif X^{(1)}_t  =  Ïƒ_t  \dif W_t)  ,  \\
                X^{(2)}_t  & =  âˆ«_0^t Î³(s) \dif W_s  &&  (\text{so } \dif X^{(2)}_t  =  Î³(t) \dif W_t)  ,  \\
        \text{ and }  Y^t  & =  âˆ«_t^1 Î³(s) \dif W_s  &&  (\text{so }       \dif Y^t  = -Î³(t) \dif W_t) .
    \end{align*}
    Then we can write \( Z(t) = Î¸\br{t, X^{(1)}_t, X^{(2)}_t, Y^t} \).

    For conciseness, we denote \( F = f\br{âˆ«_0^1 Î³(t) \dif W_t - âˆ«_s^t Î³(u) ~ Ïƒ_u \dif u} \), and similarly the derivatives \( F' = f' \br{âˆ«_0^1 Î³(t) \dif W_t - âˆ«_s^t Î³(u) ~ Ïƒ_u \dif u} \) and \( F'' = f'' \br{âˆ«_0^1 Î³(t) \dif W_t - âˆ«_s^t Î³(u) ~ Ïƒ_u \dif u} \). Note that for the derivatives of \( Î¸ \), we have
    \begin{align*}
        Î¸_{x_1}  & =  Î¸_{x_1 x_1}  =  Î¸ , \\
        Î¸_{x_2}  & =  Î¸_{x_1 x_2}  =  Î¸_y  =  Î¸ â‹… âˆ«_0^t F' \dif s , \\
        Î¸_{x_2 x_2}  & =  Î¸_{y y}  =  Î¸ â‹… \br{âˆ«_0^t F' \dif s}^2 + Î¸ â‹… âˆ«_0^t F''\dif s , \text{ and} \\
        Î¸_t  & =  -\frac12 Î¸ Ïƒ_t^2 + Î¸ f(x_2 + y) - Î³(t) Ïƒ_t Î¸_y ,
    \end{align*}
    where we used the Leibniz integral rule and the second line for the last identity.

    Since \( Î¾ \) is independent of the Wiener process, by \cref{thm:Ayedâ€“Kuo_differential_formula}\index{differential formula!Ayedâ€“Kuo}, we get
    \begin{align*}
        \dif Î¸ =
        &  Î¸_t \dif t + Î¸_{x_1} \dif X^{(1)}_t + Î¸_{x_2} \dif X^{(2)}_t + Î¸_{y} \dif Y^t  \\
        &  + \frac12 Î¸_{x_1 x_1} \br{\dif X^{(1)}_t}^2 + \frac12 Î¸_{x_2 x_2} \br{\dif X^{(2)}_t}^2 + Î¸_{x_1 x_2} \dif X^{(1)}_t \dif X^{(2)}_t - \frac12 Î¸_{y y} (\dif Y^t)^2 .
    \end{align*}
    Using the relationships between the derivatives of \( Î¸ \) and its differential form, we get
    \begin{align*}
        \dif Î¸
        & =  Î¸_t \dif t + Î¸ Ïƒ_t \dif W_t + \bcancel{Î¸_y Î³(t) \dif W_t} - \bcancel{Î¸ Î³(t) \dif W_t}  \\
        & \quad + \frac12 Î¸ Ïƒ_t^2 \dif t + \cancel{\frac12 Î¸_{y y} Î³(t)^2 \dif t} + Î¸_y Î³(t) Ïƒ_t \dif t - \cancel{\frac12 Î¸_{y y} Î³(t)^2 \dif t}  \\
        & = \br{Î¸_t + \frac12 Î¸ Ïƒ_t^2 + Î¸_y Î³(t) Ïƒ_t} \dif t + Î¸ Ïƒ_t \dif W_t .
    \end{align*}
    Now,
    \begin{equation*}
        Î¸_t + \frac12 Î¸ Ïƒ_t^2 + Î¸_y Î³(t) Ïƒ_t
        =  \br{ -\bcancel{\frac12 Î¸ Ïƒ_t^2} + Î¸ f(x_2 + y) - \cancel{Î¸_y Î³(t) Ïƒ_t} } + \bcancel{\frac12 Î¸ Ïƒ_t^2} + \cancel{Î¸_y Î³(t) Ïƒ_t}
        =  Î¸ f(x_2 + y) ,
    \end{equation*}
    and so
    \[ \dif Î¸  =  f(x_2 + y) Î¸ \dif t + Ïƒ_t Î¸ \dif W_t . \]
    Since \( Z(t) = Î¸\br{t, X^{(1)}_t, X^{(2)}_t, Y^t} \), we get
    \[ \dif Z(t) = f\br{âˆ«_0^1 Î³(s) \dif W_s} Z(t) \dif t + Ïƒ_t ~ Z(t) \dif W_t , \]
    which is exactly \cref{eqn:SDE_drift}.
\end{proof}

The differential formula (\Cref{thm:Ayedâ€“Kuo_differential_formula}) is an indispensable tool for analyzing anticipating processes. We show another example by finding the stochastic differential equation corresponding to the square of the above solution.

\begin{theorem}  \label{thm:SDE_drift_solution_squared}
    Under the condition of \cref{thm:SDE_drift_Ayedâ€“Kuo}, the stochastic differential equation
    \begin{equation*}
        \left\{
        \begin{aligned}
            \dif V(t)
            & =  \bs{ Ïƒ_t^2 + f\br{âˆ«_0^1 Î³(s) \dif W_s} + 2 Î³(t) ~ Ïƒ_t âˆ«_0^t f'\br{âˆ«_0^1 Î³(u) \dif W_u - âˆ«_s^t Î³(u) ~ Ïƒ_u \dif u} \dif s } V(t) \dif t  \\
            & \quad  + 2 Ïƒ_t ~ V(t) \dif W_t , \\
            V(0)  & =  Î¾^2
        \end{aligned}
        \right.
    \end{equation*}
    is solved by \( Z(t)^2 \), where \( Z \) is given by \cref{eqn:SDE_drift_solution_Ayedâ€“Kuo}.
\end{theorem}

\begin{remark}
    An interesting feature is that the derivative of \( f \) appears in the stochastic differential equation.
\end{remark}

\begin{proof}
    We follow the exact same strategy as the proof of \cref{thm:SDE_drift_Ayedâ€“Kuo}. The initial condition is trivially true. Let \( V(t) = Z(t)^2 \).

    Taking the square of both sides of \cref{eqn:SDE_drift_solution_Ayedâ€“Kuo}, we get
    \begin{align*}
        V(t) = Î¾^2 \exp\bs{ âˆ«_0^t 2 Ïƒ_s \dif W_s - âˆ«_0^t Ïƒ_s^2 \dif s + âˆ«_0^t 2 f\br{ âˆ«_0^1 Î³(u) \dif W_u - âˆ«_s^t Î³(u) ~ Ïƒ_u \dif u } \dif s }
    \end{align*}
    We have \( V(t) = Î¸\br{t, X^{(1)}_t, X^{(2)}_t, Y^t} \), where
    \begin{align*}
        Î¸(t, x_1 , x_2 , y) = Î¾^2 \exp\bs{ x_1  - âˆ«_0^t Ïƒ_s^2 \dif s + âˆ«_0^t 2 f\br{ x_2 + y - âˆ«_s^t Î³(u) ~ Ïƒ_u \dif u } \dif s } ,
    \end{align*}
    and
    \begin{align*}
                X^{(1)}_t  & =  âˆ«_0^t 2 Ïƒ_s \dif W_s  &&  (\text{so } \dif X^{(1)}_t  =  2 Ïƒ_t \dif W_t)  ,  \\
                X^{(2)}_t  & =  âˆ«_0^t Î³(s) \dif W_s    &&  (\text{so } \dif X^{(2)}_t  =  Î³(t) \dif W_t)  ,  \\
        \text{ and }  Y^t  & =  âˆ«_t^1 Î³(s) \dif W_s    &&  (\text{so }       \dif Y^t  = -Î³(t) \dif W_t) .
    \end{align*}
    As before, writing \( F = f\br{âˆ«_0^1 Î³(t) \dif W_t - âˆ«_s^t Î³(u) ~ Ïƒ_u \dif u} \), \( F' = f'\br{âˆ«_0^1 Î³(t) \dif W_t - âˆ«_s^t Î³(u) ~ Ïƒ_u \dif u} \), and \( F'' = f''\br{âˆ«_0^1 Î³(t) \dif W_t - âˆ«_s^t Î³(u) ~ Ïƒ_u \dif u} \), we get
    \begin{align*}
        Î¸_{x_1}  & =  Î¸_{x_1 x_1}  =  Î¸ , \\
        Î¸_{x_2}  & =  Î¸_{x_1 x_2}  =  Î¸_y  =  2 Î¸ â‹… âˆ«_0^t F' \dif s , \\
        Î¸_{x_2 x_2}  & =  Î¸_{y y}  =  Î¸ â‹… \br{âˆ«_0^t F' \dif s}^2 + Î¸ â‹… âˆ«_0^t F''\dif s , \text{ and} \\
        Î¸_t  & =  -Î¸ Ïƒ_t^2 + 2 Î¸ f(x_2 + y) - Î³(t) Ïƒ_t Î¸_y .
    \end{align*}

    Using the above in \cref{thm:Ayedâ€“Kuo_differential_formula}, we get
    \begin{align*}
        \dif Î¸
        = &  Î¸_t \dif t + Î¸_{x_1} \dif X^{(1)}_t + Î¸_{x_2} \dif X^{(2)}_t + Î¸_{y} \dif Y^t  \\
          &  + \frac12 Î¸_{x_1 x_1} \br{\dif X^{(1)}_t}^2 + \frac12 Î¸_{x_2 x_2} \br{\dif X^{(2)}_t}^2 + Î¸_{x_1 x_2} \dif X^{(1)}_t \dif X^{(2)}_t - \frac12 Î¸_{y y} (\dif Y^t)^2  \\
        = &  Î¸_t \dif t + 2 Î¸ Ïƒ_t \dif W_t + \bcancel{Î¸_{x_2} Î³(t) \dif W_t} - \bcancel{Î¸ Î³(t) \dif W_t}  \\
          &  + 2 Î¸ Ïƒ_t^2 \dif t + \cancel{\frac12 Î¸_{x_2 x_2} Î³(t)^2 \dif t} + 2 Î¸_y Î³(t) Ïƒ_t \dif t - \cancel{\frac12 Î¸_{y y} Î³(t)^2 \dif t}  \\
        = &  \br{Î¸_t + 2 Î¸ Ïƒ_t^2 + 2 Î¸_y Î³(t) Ïƒ_t} \dif t + 2 Î¸ Ïƒ_t \dif W_t  \\
        = &  \bs{Î¸ Ïƒ_t + 2 Î¸ f(x_2 + y) + 2 Î³(t) Ïƒ_t Î¸ âˆ«_0^t F' \dif s} \dif t + 2 Î¸ Ïƒ_t \dif W_t .
    \end{align*}
    Finally, using \( V(t) = Î¸\br{t, X^{(1)}_t, X^{(2)}_t, Y^t} \), we get the stochastic differential equation.
\end{proof}



\section{Solution in the Skorokhod sense}  \label{sec:SDE_drift_Skorokhod}  \index{Malliavin calculus}  \index{integral!Skorokhod}  \index{stochastic differential equation!existence}  \index{stochastic differential equation!uniqueness}
In the prior section, we showed the existence of the solution via the Ayedâ€“Kuo differential formula. However, the procedure started with intelligently guessing an ansatz for the solution and applying the differential formula to it. Can a solution be found without this \textquote{guessing}? In this section, we use elementary ideas from Malliavin calculus to interpret the stochastic differential equation in the Skorokhod sense. Then we introduce an iterative \textquote{braiding} technique\index{braiding technique} in the spirit of Trotter's product formula\index{Trotter's product formula}\cite{Trotter1959} that allows us to construct the solution without needing to know the form of the solution. Note that we expect to arrive at the same solution as in \cref{sec:SDE_drift_Ayedâ€“Kuo} since under the definition of the Ayedâ€“Kuo integral using \( L^2(Î©) \) convergence, the Hitsudaâ€“Skorokhod integral and the Ayedâ€“Kuo integrals are equivalent, as shown in \cite[theorem 2.3]{PeterParczewski2017}.

In this section, we use subscripts throughout for time. First, fix the family of translation \( A_t : ğ’_0 â†’ ğ’_0 \) in the Cameronâ€“Martin direction given by
\begin{equation*}
    (A_t(Ï‰))_s  =  Ï‰_s - âˆ«_0^{t âˆ§ s} Ïƒ(u) \dif u
    \qquad  \text{ and }  \qquad
    (T_t(Ï‰))_s  =  Ï‰_s + âˆ«_0^{t âˆ§ s} Ïƒ(u) \dif u .
\end{equation*}

We look at an existence result for stochastic differential equations in the Skorokhod sense.
\begin{lemma}  \label{thm:SDE_Skorokhod_base}
    Suppose \( Ïƒ âˆˆ L^2[0, 1] \) and \( Î¾ âˆˆ L^p(Î©) \) for some \( p > 2 \).
    Then the stochastic differential equation
    \begin{equation}  \label{eqn:SDE_Skorokhod_base}
        \left\{
        \begin{aligned}
            \dif Z(t)  & =  Ïƒ(t) ~ Z(t) \dif W_t  \\
            Z(0)  & =  Î¾ ,
        \end{aligned}
        \right.
    \end{equation}
    has the unique solution given by
    \begin{equation}  \label{eqn:SDE_Skorokhod_base_solution}
        Z(t) =  (Î¾ âˆ˜ A_t) ~ â„°_t .
    \end{equation}
\end{lemma}
\begin{proof}
   It is clear that the family \( \bc{ (Î¾ âˆ˜ A_t) â„°_t \given t âˆˆ [0, 1] } \) is \( L^r(Î©) \)-bounded for all \( r < p \) by Girsanov's theorem\index{Girsanov's theorem} and HÃ¶lder 's inequality\index{HÃ¶lder's inequality}. Let \( G \) be any smooth random variable. Multiply both sides of \cref{eqn:SDE_Skorokhod_base} by \( G \). With the process \( X \) given by \cref{eqn:SDE_Skorokhod_base_solution},
   \begin{align*}
       \E\br{Gâˆ«_0^t Ïƒ(s) ~ Z(s) \dif W_s}
       & =  \E\br{âˆ«_0^t Ïƒ(s) ~ Z(s) \Dif_s G \dif s}  \\
       & =  \E\br{Î¾ âˆ«_0^t Ïƒ(s) ~ (\Dif_s G)(T_s) \dif s}  \qquad  \text{(using Girsanov theorem)}  \\
       & =  \E\br{Î¾ âˆ«_0^t \frac{\dif}{\dif s} G(T_s) \dif s}  \\
       & =  \E\br{Î¾(G(T_t) - G)}  \\
       & =  \E\br{Î¾(A_t) ~ â„°_t ~ G}  - \E\br{Î¾ ~ G}  \qquad  \text{(again by Girsanov theorem)}  \\
       & =  \E\br{Z(t) ~ G} - \E\br{Î¾ ~ G} .
   \end{align*}
   Thus, a solution of the stochastic equation \cref{eqn:SDE_Skorokhod_base} is explicitly given by \cref{eqn:SDE_Skorokhod_base_solution}. Uniqueness follows since the solution of \cref{eqn:SDE_Skorokhod_base} started at \( Î¾ â‰¡ 0 \) is identically zero at all times.
\end{proof}

Now we introduce the braiding technique to generalize this to equations of the type \cref{eqn:SDE_drift}, where \( Î³ âˆˆ L^2[0, 1] \) and \( f: â„ â†’ â„ \). First, to simplify notation, define
\begin{align*}
    I_Î³  & =  âˆ«_0^1 Î³_s \dif W_s , \\
    A_u^v(Ï‰_â‹…)  & =  Ï‰_â‹… - âˆ«_u^{(â‹… âˆ§ v) âˆ¨ u} Ïƒ(s) \dif s , \\
    E_u^v  & =  \exp\bs{âˆ«_u^v Ïƒ(s) \dif W_s - \frac12 âˆ«_u^v Ïƒ(s)^2 \dif s} , \text{ and} \\
    g_u^v  & =  \exp\bs{f(I_Î³) ~ (v - u)} .
\end{align*}
Directly from the definitions above, for any \( u < v < w \), we get the compositions
\begin{align*}
    A_v^w âˆ˜ A_u^v  & =  A_u^w , \\
    E_u^v âˆ˜ A_v^w  & =  E_u^v , \\
    g_u^v âˆ˜ A_v^w  & =  \exp\bs{f(I_Î³ âˆ˜ A_v^w) ~ (v - u)} ,
\end{align*}
and the products
\begin{align*}
    E_u^v â‹… E_v^w  & =  E_u^w , \text{ and} \\
    g_u^v â‹… g_v^w  & =  g_u^w .
\end{align*}
We suppress the dependence on \( Ï‰ \) for notational convenience.

Fix \( t âˆˆ [0, 1] \), and consider a sequence of partitions \( Î _n = \bc{0 = t_0 < t_1 < \dotsb < t_n = t} \) of \( [0, t] \) such that \( \norm{Î _n} = \sup\bc{t_i - t_{i-1} \given i âˆˆ [n]} â†’ 0 \). On each subinterval, we
\begin{enumerate}
    \item  \label{itm:diffusion_step}  solve the equation having only the diffusion with the initial condition as the solution of the previous step, and
    \item  \label{itm:drift_step}  use the solution obtained in step \ref{itm:diffusion_step} as the initial condition and solve the equation having only the drift.
\end{enumerate}
For the first subinterval, the initial condition of step \ref{itm:diffusion_step} is taken to be \( Î¾ \). For a visual representation of the idea, see \cref{fig:braiding}.

\begin{figure}
    \centering
    \begin{tikzpicture}[
        decoration={markings,
        mark=at position 0.6 with {\arrow{latex}}}
    ]
        % Main timeline
        \draw [->, very thick, color=gray] (-0.5,0) -- (10.5,0) node[below] {\( t \)};
        \foreach \x/\xtext in {0/t_0=0, 2/t_1, 4/t_{2}, 7/t_{n-1}, 9/t_n=t, 10/1}
            \draw [ultra thick] (\x cm,1pt) -- (\x cm,-1pt) node[anchor=north] {$\xtext$};

        % Guide lines
        % i = 1
        \draw [very thick, densely dotted, color=Thistle, postaction={decorate}] (1.9,1) -- (0,2);
        \draw [very thick, densely dotted, color=Thistle, postaction={decorate}] (1.9,2) -- (2.1,1);
        % i = 2
        \draw [very thick, densely dotted, color=Thistle, postaction={decorate}] (3.9,1) -- (2.1,2);
        \draw [very thick, densely dotted, color=Thistle, postaction={decorate}] (3.9,2) -- (4.1,1);
        % i = k
        \draw [very thick, densely dotted, color=Thistle, postaction={decorate}] (4.9,1.5) -- (4.1,2);
        \draw [very thick, densely dotted, color=Thistle, postaction={decorate}] (6.9,1) -- (6,1.5);
        % i = n
        \draw [very thick, densely dotted, color=Thistle, postaction={decorate}] (6.9,2) -- (7.1,1);
        \draw [very thick, densely dotted, color=Thistle, postaction={decorate}] (8.9,1) -- (7.1,2);

        % X1
        \draw [very thick, color=Orchid, postaction={decorate}] (0,1) -- (1.9,1);
        \draw [color=Orchid] (1,0.7) node {\( Y^{(1)} \)};
        \draw [fill=Orchid] (1.9,1) circle (1.5pt);
        \draw [fill=DeepPink] (0,1) circle (3pt);
        \draw [color=DeepPink] (-0.3,1) node {\( Î¾ \)};

        % Y1
        \draw [very thick, color=DarkGoldenrod, postaction={decorate}] (0,2) -- (1.9,2);
        \draw [color=DarkGoldenrod] (1,2.3) node {\( X^{(1)} \)};
        \draw [fill=DarkGoldenrod] (0,2) circle (1.5pt);
        \draw [fill=DarkGoldenrod] (1.9,2) circle (1.5pt);

        % X2
        \draw [very thick, color=Orchid, postaction={decorate}] (2.1,1) -- (3.9,1);
        \draw [color=Orchid] (3,0.7) node {\( Y^{(2)} \)};
        \draw [fill=Orchid] (2.1,1) circle (1.5pt);
        \draw [fill=Orchid] (3.9,1) circle (1.5pt);

        % Y2
        \draw [very thick, color=DarkGoldenrod, postaction={decorate}] (2.1,2) -- (3.9,2);
        \draw [color=DarkGoldenrod] (3,2.3) node {\( X^{(2)} \)};
        \draw [fill=DarkGoldenrod] (2.1,2) circle (1.5pt);
        \draw [fill=DarkGoldenrod] (3.9,2) circle (1.5pt);

        % Forward time
        \draw [fill=Orchid] (4.1,1) circle (1.5pt);
        \draw [very thick, color=Orchid, postaction={decorate}] (4.1,1) -- (5,1);
        \draw [very thick, color=DarkGoldenrod,  postaction={decorate}] (4.1,2) -- (5,2);
        \draw [fill=DarkGoldenrod] (4.1,2) circle (1.5pt);

        % Backward time
        \draw [very thick, color=Orchid, postaction={decorate}] (6,1) -- (6.9,1);
        \draw [very thick, color=DarkGoldenrod, postaction={decorate}] (6,2) -- (6.9,2);
        \draw [fill=DarkGoldenrod] (6.9,2) circle (1.5pt);
        \draw [fill=Orchid] (6.9,1) circle (1.5pt);

        % Yn
        \draw [very thick, color=Orchid, postaction={decorate}] (7.1,1) -- (8.9,1);
        \draw [color=Orchid] (8,0.7) node {\( Y^{(n)} \)};
        \draw [fill=Orchid] (7.1,1) circle (1.5pt);
        \draw [fill=Orchid] (8.9,1) circle (1.5pt);

        % Xn
        \draw [very thick, color=DarkGoldenrod, postaction={decorate}] (7.1,2) -- (8.9,2);
        \draw [color=DarkGoldenrod] (8,2.3) node {\( X^{(n)} \)};
        \draw [fill=DarkGoldenrod] (7.1,2) circle (1.5pt);
        \draw [fill=DeepPink] (8.9,2) circle (3pt);
        \draw [color=DeepPink] (9.3,2) node {\( Z \)};

        \draw[color=Black] (5.5,1.5) node  {\( \dotsb \)};
        % Setup and bounding box
        % \clip(-2,-1) rectangle (9,3);
        % \draw (current bounding box.north east) rectangle (current bounding box.south west);
    \end{tikzpicture}
    \caption{A graphical representation of the braiding technique.}
    \label{fig:braiding}
\end{figure}

We explicitly demonstrate the process for the first two subintervals. An index \( (i) \) in the superscript refers to the \( i \)th subinterval.

\paragraph{First subinterval.}
\begin{enumerate}
    \item  The stochastic differential equation that we want to solve is
    \begin{equation*}
        \left\{
        \begin{aligned}
            \dif Y^{(1)}_u  & =  Ïƒ(u) Y^{(1)}_u \dif W_u ,  \quad  u âˆˆ [0, t_1] , \\
                 Y^{(1)}_0  & =  Î¾ .
        \end{aligned}
        \right.
    \end{equation*}
    \Cref{thm:SDE_Skorokhod_base} gave us the almost sure unique solution \( Y^{(1)}_u = (Î¾ âˆ˜ A_0^u) ~ E_0^u \), so
    \[ Y^{(1)}_{t_1} = (Î¾ âˆ˜ A_0^{t_1}) ~ E_0^{t_1} \]
    on a set \( Î©_1 \), where \( \Pr\br{Î©_1} = 1 \).

    \item  For each \( Ï‰ âˆˆ Î©_1 \), we want to solve the ordinary differential equation
    \begin{equation*}
        \left\{
        \begin{aligned}
            \dif X^{(1)}_u  & =  f(I_Î³) ~ X^{(1)}_u \dif u ,  \quad  u âˆˆ [0, t_1] , \\
                 X^{(1)}_0  & =  Y^{(1)}_{t_1} .
        \end{aligned}
        \right.
    \end{equation*}
    By the existence and uniqueness theorem of ordinary differential equations, the unique solution is given by \( X^{(1)}_u  =  Y^{(1)}_{t_1} ~ g_0^u  =  (Î¾ âˆ˜ A_0^{t_1}) ~ E_0^{t_1} ~ g_0^u \), and so
    \[ X^{(1)}_{t_1}  =  (Î¾ âˆ˜ A_0^{t_1}) ~ E_0^{t_1} ~ g_0^{t_1}  . \]
\end{enumerate}

\paragraph{Second subinterval.}
\begin{enumerate}
    \item  The stochastic differential equation that we want to solve is
    \begin{equation*}
        \left\{
        \begin{aligned}
            \dif Y^{(2)}_u  & =  Ïƒ(u) ~ Y^{(2)}_u \dif W_u ,  \quad  u âˆˆ [t_1, t_2] , \\
                 Y^{(2)}_{t_1}  & =  X^{(1)}_{t_1} .
        \end{aligned}
        \right.
    \end{equation*}
    \Cref{thm:SDE_Skorokhod_base} gives us the almost sure unique solution \( Y^{(2)}_u = (X^{(1)}_{t_1} âˆ˜ A_{t_1}^u) ~ E_{t_1}^u \). Now,
    \begin{align*}
        Y^{(2)}_u
        & =  \bs{\br{(Î¾ âˆ˜ A_0^{t_1}) ~ E_0^{t_1} ~ g_0^{t_1}} âˆ˜ A_{t_1}^u} ~ E_{t_1}^u  \\
        & =  (Î¾ âˆ˜ A_0^{t_1} âˆ˜ A_{t_1}^u) ~ E_0^{t_1} ~ E_{t_1}^u ~ (g_0^{t_1} âˆ˜ A_{t_1}^u)  \\
        & =  (Î¾ âˆ˜ A_0^u) ~ E_0^u ~ (g_0^{t_1} âˆ˜ A_{t_1}^u) ,
    \end{align*}
    where we used the fact that \( E_0^{t_1} \) is invariant under \( A_{t_1}^u \). This is because, by definition,
    \[ A_{t_1}^u(Ï‰_â‹…)  =  Ï‰_â‹… - âˆ«_{t_1}^{(â‹… âˆ§ u) âˆ¨ t_1} Ïƒ(s) \dif s . \]
    Now, for \( E_0^{t_1} \), we have \( t âˆˆ [0, t_1] \). Therefore,
    \[ A_{t_1}^u(Ï‰_t)  =  Ï‰_t - âˆ«_{t_1}^{t_1} Ïƒ(s) \dif s = Ï‰_t , \]
    showing the invariance. This gives the motivation behind why we define \( A \) as such, and is a key trick in the method.

    Continuing, we get
    \[ Y^{(2)}_{t_2} = (Î¾ âˆ˜ A_0^{t_2}) ~ E_0^{t_2} ~ (g_0^{t_1} âˆ˜ A_{t_1}^{t_2}) \]
    on a set \( Î©_2 âŠ† Î©_1 \), where \( \Pr\br{Î©_2} = 1 \).

    \item  For each \( Ï‰ âˆˆ Î©_2 \), we have the ordinary differential equation
    \begin{equation*}
        \left\{
        \begin{aligned}
            \dif X^{(2)}_u  & =  f(I_Î³) ~ X^{(2)}_u \dif u ,  \quad  u âˆˆ [t_1, t_2] , \\
                 X^{(2)}_{t_1}  & =  Y^{(2)}_{t_1} .
        \end{aligned}
        \right.
    \end{equation*}
    The unique solution is given by \( X^{(2)}_u  =  Y^{(2)}_{t_1} ~ g_{t_1}^u \). Using the definition of \( Y^{(2)}_{t_1} \) and the fact that \( A_{t_2}^{t_2} \) is the identity function,
    \begin{align*}
        X^{(2)}_{t_2}
        & =  \bs{(Î¾ âˆ˜ A_0^{t_2}) ~ E_0^{t_2} ~ (g_0^{t_1} âˆ˜ A_{t_1}^{t_2})} ~ (g_{t_1}^{t_2} âˆ˜ A_{t_2}^{t_2})  \\
        & =  (Î¾ âˆ˜ A_0^{t_2}) ~ E_0^{t_2} ~ âˆ_{i = 1}^2 (g_{t_1}^{t_2} âˆ˜ A_{t_2}^{t_2})
    \end{align*}
\end{enumerate}

It should now become obvious what the pattern is. We prove this using induction in the following lemma.

\begin{lemma}  \label{thm:braiding}
    Let \( Î¾ âˆˆ L^p(Î©) \) for some \( p > 2 \). Consider the \( k \)th subinterval \( u âˆˆ [t_{k-1}, t_k] \) for any \( k âˆˆ [n] \), and define
    \begin{enumerate}
        \item  the stochastic differential equation
        \begin{equation*}
            \left\{
            \begin{aligned}
                   \dif Y^{(k)}_u  & =  Ïƒ(u) ~ Y^{(k)}_u \dif W_u ,  \quad  u âˆˆ [t_{k-1}, t_k] , \\
                Y^{(k)}_{t_{k-1}}  & =  X^{({k-1})}_{t_{k-1}} , \text{ and}
            \end{aligned}
            \right.
        \end{equation*}

        \item  the ordinary differential equation
        \begin{equation*}
            \left\{
            \begin{aligned}
                   \dif X^{(k)}_u  & =  f(I_Î³) ~ X^{(k)}_u \dif u ,  \quad  u âˆˆ [t_{k-1}, t_k] , \\
                X^{(k)}_{t_{k-1}}  & =  Y^{(k)}_{t_k} .
            \end{aligned}
            \right.
        \end{equation*}
    \end{enumerate}
    Then there exists a set \( Î©_k âŠ† Î© \) with \( \Pr\br{Î©_k} = 1 \) such that on \( Î©_k \), we have
    \[ X^{(k)}_{t_k} =  (Î¾ âˆ˜ A_0^{t_k}) ~ E_0^{t_k} ~ âˆ_{i = 1}^k (g_{t_{i-1}}^{t_i} âˆ˜ A_{t_i}^{t_k}) . \]
\end{lemma}

\begin{proof}
    \emph{Base cases.} This is true for \( k = 1 \) and \( k = 2 \) as shown in the computations above.

    \emph{Induction step.} Assume that the result holds for \( k = m-1 \). This means that there exists \( Î©_{m-1} \) with \( \Pr\br{Î©_{m-1}} = 1 \) such that on \( Î©_{m-1} \), we have
    \[ X^{(m-1)}_{t_{m-1}} =  (Î¾ âˆ˜ A_0^{t_{m-1}}) ~ E_0^{t_{m-1}} â‹… âˆ_{i = 1}^{m-1} (g_{t_{i-1}}^{t_i} âˆ˜ A_{t_i}^{t_{m-1}}) . \]

    Using the ideas of computations on the second subinterval, we get that there exists \( Î©_m \) with \( \Pr\br{Î©_m} = 1 \) such that on \( Î©_m \), we have
    \[ Y^{(m)}_{t_m} = (Î¾ âˆ˜ A_0^{t_m}) ~ E_0^{t_m} ~ âˆ_{i = 1}^{m-1} (g_{t_{i-1}}^{t_i} âˆ˜ A_{t_i}^{t_m}) . \]
    Since \( A_{t_m}^{t_m} \) is the identity function, on \( Î©_m \), we have
    \begin{align*}
        X^{(m)}_{t_m}
        & =  Y^{(m)}_{t_{m-1}} ~ g_{t_{m-1}}^{t_m}  \\
        & = (Î¾ âˆ˜ A_0^{t_m}) ~ E_0^{t_m} ~ âˆ_{i = 1}^m (g_{t_{i-1}}^{t_i} âˆ˜ A_{t_i}^{t_m}) .
    \end{align*}

    The proof is now complete by mathematical induction.
\end{proof}

We are now able to derive a closed form solution of \cref{eqn:SDE_drift} in the Skorokhod sense. This is the main theorem of the section.

\begin{theorem}  \label{thm:SDE_drift_Skorokhod}
    Suppose \( Ïƒ, Î³ âˆˆ L^2[0, 1] \), \( f: â„ â†’ â„ \), and \( Î¾ âˆˆ L^p(Î©) \) for some \( p > 2 \). Then the unique solution of \cref{eqn:SDE_drift} in the Skorokhod sense is given by
    \begin{align*}  \label{eqn:SDE_drift_solution_Skorokhod}
        Z(t)  =  (Î¾ âˆ˜ A_0^t) \exp
        &  \left[ âˆ«_0^t Ïƒ(s) \dif W_s - \frac12 âˆ«_0^t Ïƒ(s)^2 \dif s \right.  \\
        &  \left. + âˆ«_0^t f\br{ âˆ«_0^1 Î³(u) \dif W_u - âˆ«_s^t Î³(u) ~ Ïƒ(u) \dif u } \dif s \right] .
    \end{align*}
\end{theorem}

\begin{remark}
    Note that \( Î¾ \) may depend on the Wiener process.
\end{remark}

\begin{proof}
    Using \cref{thm:braiding}, for any \( t âˆˆ [0, 1] \), we have
    \[ X^{(n)}_t =  (Î¾ âˆ˜ A_0^t) ~ E_0^t ~ âˆ_{i = 1}^k (g_{t_{i-1}}^{t_i} âˆ˜ A_{t_i}^t) . \]
    Now,
    \begin{align*}
        âˆ_{i = 1}^k (g_{t_{i-1}}^{t_i} âˆ˜ A_{t_i}^t)
        & =  âˆ_{i = 1}^k \exp\bs{f(I_Î³ âˆ˜ A_{t_i}^t) ~ (t_i - t_{i-1})}  \\
        & =  \exp\bs{âˆ‘_{i = 1}^k f\br{âˆ«_0^1 Î³(u) \dif W_u - âˆ«_0^t Î³(u) ~ Ïƒ(u) \dif u} \Del t_i} .
    \end{align*}
    Finally, taking \( n â†’ âˆ \), we get
    \begin{align*}
        Z(t)
        & =  \lim_{n â†’ âˆ} X^{(n)}_t  \\
        & =  (Î¾ âˆ˜ A_0^t) ~ E_0^t ~ \exp\bs{âˆ«_0^t f\br{âˆ«_0^1 Î³(u) \dif W_u - âˆ«_0^t Î³(u) ~ Ïƒ(u) \dif u} \dif s} ,
    \end{align*}
    which exactly equals the proposed solution.

    The solution exists almost surely, due to the continuity of the measure. Moreover, the solution is unique. For if not, there are two solutions which disagree for the first time on a particular interval, say the \( k \)th interval. Recall that the solutions obtained using Malliavin calculus and also for ordinary differential equations are unique for each interval of time. Therefore, such a disagreement would violate these uniqueness results.
\end{proof}
